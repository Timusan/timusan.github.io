<!DOCTYPE html>
<html><body>
<p>## -*- coding: utf-8 -*-



%block&gt;


    ${ui.bar(crumbs)}
    %if title:
    </p>
<h1>${title|h}</h1>
    %endif
    %if post:
    <p>
        ${post.text()}
    </p>
    %endif
    %if folders:
    <ul>
    % for folder, ftitle in folders:
        <li><a href="%24%7Bfolder%7D"><i class="icon-folder-open"></i>Â ${ftitle|h}</a></li>
    % endfor
    </ul>
    %endif

<div id="gallery_container"></div>
%if photo_array:
<noscript>
<ul class="thumbnails">
    %for image in photo_array:
        <li>
<a href="%24%7Bimage%5B'url'%5D%7D" class="thumbnail image-reference" title="${image['title']|h}">
            <img src="%24%7Bimage%5B'url_thumb'%5D%7D" alt="${image['title']|h}"></a>
    %endfor
</li>
</ul>
</noscript>
%endif
%if site_has_comments and enable_comments:
    ${comments.comment_form(None, permalink, title)}
%endif
%block&gt;


${parent.extra_head()}
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<style type="text/css">
    .image-block {
        display: inline-block;
    }
    .flowr_row {
        width: 100%;
    }
    </style>
%if len(translations) &gt; 1:
    %for langname in translations.keys():
         %if langname != lang:
             <link rel="alternate" hreflang="${langname}" href="%24%7B_link('gallery',%20gallery_path,%20langname)%7D">
         %endif
    %endfor
%endif
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">%block&gt;


<script src="../assets/js/flowr.js"></script><script>
jsonContent = ${photo_array_json};
flowr(document.querySelectorAll("#gallery_container")[0], {
        data : jsonContent,
        height : ${thumbnail_size}*.6,
        padding: 5,
        rows: -1,
        render : function(params) {
            // Just return a div, string or a dom object, anything works fine
            var img = document.createElement("img");
            img.setAttribute('src', params.itemData.url_thumb);
            img.setAttribute('width', params.width);
            img.setAttribute('height', params.height);
            img.setAttribute('alt', params.itemData.title);
            img.style.maxWidth = '100%';
            link = document.createElement("a");
            link.setAttribute('href', params.itemData.url);
            link.setAttribute('class', 'image-reference');
            div = document.createElement("div");
            div.setAttribute('class', 'image-block');
            div.setAttribute('title', params.itemData.title);
            div.setAttribute('data-toggle', "tooltip")
            link.append(img);
            div.append(link);
            //div.hover(div.tooltip());
            return div;
        },
        itemWidth : function(data) { return data.size.w; },
        itemHeight : function(data) { return data.size.h; },
        complete : function(params) {
            if( jsonContent.length > params.renderedItems ) {
                nextRenderList = jsonContent.slice( params.renderedItems );
            }
        }
    });
    baguetteBox.run('#gallery_container', {
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>%block&gt;</body></html>
